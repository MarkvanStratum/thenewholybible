<!DOCTYPE html>
<html lang="hy">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>‘±’∂’æ’ø’°’∂’£ ’æ’≥’°÷Ä’∏÷Ç’¥</title>

<style>
:root{--bg:#fafafa;--text:#0a2540;--muted:#5b6b82;--line:#e5e7eb;}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);font-family:Inter,system-ui}
.wrap{max-width:1100px;margin:auto;padding:20px}
.grid{display:grid;grid-template-columns:1fr 360px;gap:18px}
.card{background:#fff;border:1px solid var(--line);padding:22px;border-radius:12px}
.widget{background:#fff;border:1px solid var(--line);padding:16px;border-radius:12px}
.input,.select{width:100%;padding:12px;border-radius:10px;border:1px solid #cfd6e4}
.btn{width:100%;padding:12px;background:#16a34a;color:#fff;border:none;border-radius:12px;font-weight:700}
.h2{font-weight:800;margin-bottom:10px}
.form-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.order-row{display:flex;justify-content:space-between;margin-top:10px}
</style>

</head>
<body>

<div class="wrap">

<h1>‘±’∂’æ’ø’°’∂’£ ’æ’≥’°÷Ä’∏÷Ç’¥ üîí</h1>

<div class="grid">

<!-- LEFT -->
<div class="card">

<!-- HERO (affiliate product preview) -->
<div id="hero" style="display:none;gap:10px;margin-bottom:12px;align-items:center">
  <img id="heroImg" style="width:50px;height:50px;border-radius:8px;border:1px solid #ddd">
  <div>
    <div id="heroTitle" style="font-weight:800;font-size:14px"></div>
    <div style="font-size:12px;color:#666">‘±’∫÷Ä’°’∂÷Ñ ’±’•÷Ä ’∞’≤’∏÷Ç’¥’´÷Å</div>
  </div>
</div>

<h2 class="h2">1. ’è’æ’µ’°’¨’∂’•÷Ä</h2>

<div class="form-grid">
<input id="firstName" class="input" placeholder="‘±’∂’∏÷Ç’∂">
<input id="lastName" class="input" placeholder="‘±’¶’£’°’∂’∏÷Ç’∂">
</div>

<div class="form-grid">
<input id="address" class="input" placeholder="’Ä’°’Ω÷Å’•" style="grid-column:1/-1">
<input id="zip" class="input" placeholder="’ì’∏’Ω’ø’°’µ’´’∂ ’Ø’∏’§">
<input id="city" class="input" placeholder="’î’°’≤’°÷Ñ">
</div>

<div class="form-grid">
<input id="email" class="input" placeholder="‘∑’¨‚Ä§ ÷É’∏’Ω’ø">
<input class="input" value="’Ä’°’µ’°’Ω’ø’°’∂" disabled>
</div>

<div class="form-grid">
<select class="select">
<option>+374 ‚Äî ’Ä’°’µ’°’Ω’ø’°’∂</option>
</select>
<input id="phone" class="input" placeholder="’Ä’•’º’°’≠’∏’Ω">
</div>

<button onclick="nextStep()" class="btn">’á’°÷Ä’∏÷Ç’∂’°’Ø’•’¨</button>

<!-- PAYMENT -->
<div id="payment" style="display:none">

<h2 class="h2">2. ’é’≥’°÷Ä’∏÷Ç’¥</h2>

<div id="card-number" class="input"></div>
<div class="form-grid">
<div id="card-expiry" class="input"></div>
<div id="card-cvc" class="input"></div>
</div>

<button onclick="pay()" class="btn">’é’≥’°÷Ä’•’¨ ’°’∂’æ’ø’°’∂’£</button>

</div>

</div>

<!-- RIGHT -->
<div>

<div class="widget">
<h3>’ä’°’ø’æ’•÷Ä’´ ’°’¥÷É’∏÷É’∏÷Ç’¥</h3>
<div class="order-row">
<span>‘∏’∂’§’∞’°’∂’∏÷Ç÷Ä</span>
<span>880 ÷è</span>
</div>
</div>

<div class="widget">
<h3>‘ª’∂’π’∏÷Ç ’æ’Ω’ø’°’∞’•’¨ ’¥’•’¶</h3>
<p>üîí SSL ’∫’°’∑’ø’∫’°’∂’∏÷Ç’©’µ’∏÷Ç’∂</p>
<p>‚≠ê 99% ’§÷Ä’°’Ø’°’∂ ’Ø’°÷Ä’Æ’´÷Ñ’∂’•÷Ä</p>
</div>

</div>

</div>

</div>

<script src="https://js.stripe.com/v3"></script>

<script>
window.addEventListener('DOMContentLoaded', () => {

const qs = new URLSearchParams(window.location.search);

const decode = v => {
  try { return decodeURIComponent(v || ''); }
  catch { return v || ''; }
};

const hero = document.getElementById('hero');
const heroImg = document.getElementById('heroImg');
const heroTitle = document.getElementById('heroTitle');

if(qs.get('sub1')){
  const title = decode(qs.get('sub1'));
  heroTitle.textContent = title;
  hero.style.display = 'flex';
  document.querySelector('h1').textContent = title + " üîí";
}

if(qs.get('sub2')){
  heroImg.src = decode(qs.get('sub2'));
  hero.style.display = 'flex';
}


// PREFILL FIELDS
if(qs.get('sub3')) document.getElementById('firstName').value = decode(qs.get('sub3'));
if(qs.get('sub4')) document.getElementById('lastName').value = decode(qs.get('sub4'));
if(qs.get('sub5')) document.getElementById('address').value = decode(qs.get('sub5'));
if(qs.get('sub6')) document.getElementById('zip').value = decode(qs.get('sub6'));
if(qs.get('sub7')) document.getElementById('city').value = decode(qs.get('sub7'));
if(qs.get('sub9')) document.getElementById('email').value = decode(qs.get('sub9'));

if(qs.get('sub10')) {
  document.getElementById('phone').value =
    decode(qs.get('sub10')).replace(/[^\d]/g,'');
}


// STEP SWITCH
function nextStep(){
document.getElementById("payment").style.display="block";
}

// =======================
// STRIPE SETUP
// =======================

// üëâ INSERT YOUR STRIPE PUBLIC KEY HERE
const stripe = Stripe("pk_live_51SxKzcEAzUPDR2OIpDpc6lPbCweDLEimW1e69ZWMFUfHUM5ADNc0BubRUJjcMEV6aDyO4Cvtr2zscg8upTpCK0GR00UEw83sDh");

const elements = stripe.elements();

const cardNumber = elements.create('cardNumber');
const cardExpiry = elements.create('cardExpiry');
const cardCvc = elements.create('cardCvc');

cardNumber.mount('#card-number');
cardExpiry.mount('#card-expiry');
cardCvc.mount('#card-cvc');


// =======================
// PAYMENT FUNCTION
// =======================

async function pay(){

// üëâ CREATE PAYMENT METHOD
const pm = await stripe.createPaymentMethod({
type: "card",
card: cardNumber,
billing_details: {
name: document.getElementById("firstName").value,
email: document.getElementById("email").value,
phone: "+374" + document.getElementById("phone").value,
address: {
city: document.getElementById("city").value,
postal_code: document.getElementById("zip").value,
country: "AM"
}
}
});

// üëâ CALL YOUR BACKEND HERE
// YOU MUST CREATE THIS ENDPOINT YOURSELF

const res = await fetch("/api/stripe/one-time-28-95", {
method: "POST",
headers: {"Content-Type":"application/json"},
body: JSON.stringify({
paymentMethodId: pm.paymentMethod.id,
amount: 200 // cents (if charging ‚Ç¨2)
})
});

const data = await res.json();

// üëâ CONFIRM PAYMENT
const result = await stripe.confirmCardPayment(data.clientSecret);

if(result.paymentIntent.status === "succeeded"){

// üëâ CHANGE THIS URL
window.location.href = "https://cudsr.bemobtrcks.com/go/6b6e67d8-fe22-4816-8318-ef7cf7685f83";

}else{
alert("’é’≥’°÷Ä’∏÷Ç’¥’® ’±’°’≠’∏’≤’æ’•÷Å");
}

}

});


</script>

</body>
</html>
