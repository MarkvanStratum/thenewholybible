<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>GlucoNova ‚Ä¢ Glucose Management Free Trial</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet"/>
<style>
  :root{
    --brand:#e11d2a;       /* GlucoNova red */
    --brand-2:#0177ff;     /* electric blue accent */
    --accent:#22a559;      /* wellness green */
    --ink:#0b1220;
    --muted:#5b6472;
    --line:#e5e7eb;
    --radius:18px;
    /* NEW: match to your bottle image background */
    --product-bg:#F2F2F2;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font:16px/1.5 Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
    color:var(--ink);
    background: radial-gradient(1200px 600px at 10% -10%, #fff0f1 0%, #ffffff 50%, #f4f9ff 100%);
  }

  /* Subtle sparkles */
  .sparkles{position:absolute;inset:0;pointer-events:none;overflow:hidden}
  .sparkles i{position:absolute;width:6px;height:6px;border-radius:50%;background:rgba(255,255,255,.9);box-shadow:0 0 20px rgba(225,29,42,.65),0 0 8px rgba(1,119,255,.35);animation:float 8s linear infinite}
  .sparkles i:nth-child(2){width:8px;height:8px;animation-duration:10s;left:15%}
  .sparkles i:nth-child(3){width:5px;height:5px;animation-duration:12s;left:70%}
  .sparkles i:nth-child(4){width:7px;height:7px;animation-duration:9s;left:85%}
  @keyframes float{0%{transform:translateY(120%)}100%{transform:translateY(-20%)}}

  /* Ribbon */
  .ribbon{background:linear-gradient(90deg,var(--brand),#ff6a88);color:#fff;font-weight:900;text-transform:uppercase;letter-spacing:.3px;position:relative;z-index:2}
  .ribbon .wrap{display:flex;align-items:center;gap:14px;padding:10px 16px;max-width:1200px;margin:0 auto}
  .pill{background:rgba(255,255,255,.18);padding:5px 12px;border-radius:999px;border:1px solid rgba(255,255,255,.45)}
  .timer{margin-left:auto;display:flex;gap:18px;font-weight:900}
  .timer span{display:flex;gap:6px;align-items:center}

  /* Hero */
  .hero{position:relative;border-bottom:1px solid var(--line);}
  .hero .wrap{max-width:1200px;margin:0 auto;padding:34px 16px;display:grid;grid-template-columns:1.15fr 1fr;gap:28px;align-items:center}
  .brand{display:flex;align-items:center;gap:12px;font-weight:900;font-size:40px;letter-spacing:.2px}
  .logoDot{width:30px;height:30px;border-radius:50%;background:var(--brand);position:relative;box-shadow:0 10px 30px rgba(225,29,42,.25)}
  .logoDot:after{content:"";position:absolute;inset:6px 10px 6px 6px;border-radius:46% 14% 46% 46%/46% 14% 46% 46%;background:#fff;transform:rotate(-35deg)}
  .hero h1{font-size:38px;margin:14px 0 10px}
  .sub{font-size:18px;color:#2b3340}
  .badges{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:16px}
  .badge{background:#fff;border:1px solid var(--line);border-radius:14px;padding:14px;text-align:center;box-shadow:0 8px 26px rgba(1,119,255,.06)}
  .badge b{display:block;margin-top:6px}
  .product-hero{min-height:300px;border-radius:22px;border:1px solid var(--line);background:var(--product-bg) url('gluco.jpg') center/contain no-repeat;box-shadow:0 18px 50px rgba(1,119,255,.08)}

  /* Flashy headline bar */
  .flash{margin-top:16px;display:flex;align-items:center;gap:12px;padding:10px 14px;border-radius:12px;background:linear-gradient(90deg,rgba(1,119,255,.12),rgba(225,29,42,.12));backdrop-filter:saturate(140%)}
  .flash strong{color:var(--brand)}

  /* Main */
  .main{max-width:1200px;margin:0 auto;padding:24px 16px;display:grid;grid-template-columns:1fr 420px;gap:24px}
  @media (max-width:1000px){.hero .wrap{grid-template-columns:1fr}.main{grid-template-columns:1fr}}

  .card{background:#fff;border:1px solid var(--line);border-radius:var(--radius);box-shadow:0 8px 24px rgba(2,18,8,.06)}
  .card .pad{padding:18px}

  /* Offer highlight */
  .offer{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
  @media (max-width:720px){.offer{grid-template-columns:1fr}}
  .tile{border:2px solid var(--line);border-radius:16px;padding:16px;position:relative}
  .tile.pop{border-color:var(--brand);box-shadow:0 0 0 4px rgba(225,29,42,.12)}
  .tile h4{margin:2px 0 6px}
  .price{font-size:28px;font-weight:900;color:var(--accent)}
  .strike{color:#96a0ad;text-decoration:line-through;font-weight:700}
  .rtag{position:absolute;top:12px;left:12px;background:var(--brand-2);color:#fff;font-size:12px;padding:5px 10px;border-radius:999px}

  /* Checkout */
  .checkout .head{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--line);padding:14px 18px}
  .checkout h3{margin:0;font-size:20px}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .row > *{min-width:0}

  .phone{display:flex;gap:10px;width:100%}
  .phone select{flex:0 0 170px}
  .phone input{flex:1 1 0%;min-width:0;width:100%}

  .input,.el,select{width:100%;display:block;padding:12px 14px;border:1.6px solid var(--line);border-radius:12px;background:#fff;color:#000}
  .input:focus,.el:focus,select:focus{outline:none;border-color:#ffd7e8;box-shadow:0 0 0 3px rgba(225,29,42,.18)}

  .paybtn{width:100%;padding:16px 18px;border-radius:14px;background:linear-gradient(180deg,var(--brand),#b3131f);color:#fff;font-weight:900;border:none;cursor:pointer;box-shadow:0 14px 30px rgba(225,29,42,.25)}
  .paybtn:hover{filter:saturate(1.06) brightness(0.98)}
  .muted{color:var(--muted);font-size:14px}
  .trust{display:flex;gap:14px;justify-content:center;padding:12px;border-top:1px solid var(--line)}
  .trust img{height:22px;opacity:.85}

  .list{display:grid;gap:10px;margin-top:6px}
  .list .li{display:flex;gap:10px}
  .check{width:18px;height:18px;border-radius:4px;background:#ffe5e8;display:inline-flex;align-items:center;justify-content:center}
  .check:after{content:"‚úì";font-size:12px;color:var(--brand)}

  .notice{border:1px dashed #ffb3bc;background:#fff8f9;color:#7a0b16;padding:10px 12px;border-radius:12px}

  /* FAQ */
  details{border:1px solid var(--line);border-radius:12px;padding:12px 14px}
  details+details{margin-top:10px}
  summary{cursor:pointer;font-weight:700}

  /* overlay */
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:100}
  .overlay[aria-hidden="false"]{display:flex}
  .box{background:#fff;border-radius:16px;max-width:520px;width:92vw;padding:22px;text-align:center;box-shadow:0 10px 28px rgba(0,0,0,.3)}
  .bar{height:10px;width:100%;background:#eef2f5;border-radius:999px;overflow:hidden;margin-top:10px}
  .bar span{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--brand),#ff9ec5);animation:load 2.2s ease-in-out infinite;border-radius:inherit}
  @keyframes load{0%{width:0%}60%{width:85%}100%{width:100%}}

  #err{margin-top:10px;font-size:14px;color:#b00020;background:#fde9eb;border:1px solid #e5b2b8;border-radius:10px;padding:8px;display:none}
  #err[aria-hidden="false"]{display:block}

  footer{padding:30px 16px;color:#3b4450;border-top:1px solid var(--line);text-align:center}
</style>
</head>
<body>
  <!-- Top ribbon -->
  <div class="ribbon">
    <div class="wrap">
      <div><span class="pill">Free Trial Launch</span> Get your first bottle on us</div>
      <div class="timer" aria-live="polite">
        <span><strong id="hh">00</strong> Hrs</span>
        <span><strong id="mm">15</strong> Min</span>
        <span><strong id="ss">00</strong> Sec</span>
      </div>
    </div>
  </div>

  <!-- Hero -->
  <section class="hero">
    <div class="sparkles" aria-hidden="true">
      <i style="left:5%"></i><i></i><i></i><i></i>
    </div>
    <div class="wrap">
      <div>
        <div class="brand"><span class="logoDot"></span> GlucoNova</div>
        <h1>Glucose Management ‚Äî Free Trial Bottle*</h1>
        <p class="sub">Just pay <b>$2.50</b> shipping & handling. <b>No hidden fees.</b> No subscriptions. We believe you'll love it and be back for more.</p>
        <div class="flash"><strong>What it supports:</strong> Healthy blood sugar, appetite control, steady energy, and weight management to help you feel your best every day.</div>
        <div class="badges">
          <div class="badge">‚öñÔ∏è <b>Weight management support</b></div>
          <div class="badge">ü©∏ <b>Healthy blood sugar</b></div>
          <div class="badge">‚ö° <b>Steady energy</b></div>
          <div class="badge">‚ù§Ô∏è <b>Cardiovascular support</b></div>
        </div>
      </div>
      <div class="product-hero" role="img" aria-label="GlucoNova Glucose Management bottle"></div>
    </div>
  </section>

  <!-- Main content -->
  <section class="main">
    <!-- Left: offer & benefits -->
    <div class="card">
      <div class="pad">
        <div class="offer">
          <div class="tile pop">
            <span class="rtag">Your Free Trial</span>
            <h4>1x GlucoNova Glucose Management (60 capsules)</h4>
            <div class="strike">$39.95</div>
            <div class="price">$0.00 today</div>
            <p class="muted">Just <b>$2.50</b> S&H at checkout ‚Äî that‚Äôs it.</p>
          </div>
          <div class="tile">
            <h4>Why we do this</h4>
            <p>We believe in our product. Try a full-size bottle for the cost of shipping. No recurring charges or hidden fees ‚Äî ever.</p>
          </div>
          <div class="tile">
            <h4>Transparency Promise</h4>
            <div class="list">
              <div class="li"><span class="check"></span><div><b>One-time</b> $2.50 shipping charge</div></div>
              <div class="li"><span class="check"></span><div><b>No subscriptions</b> added to your order</div></div>
              <div class="li"><span class="check"></span><div><b>30-Day satisfaction</b> or your S&H back</div></div>
            </div>
          </div>
        </div>

        <div class="card" style="margin-top:14px">
          <div class="pad">
            <h3>How Glucose Management can help</h3>
            <div class="list">
              <div class="li"><span class="check"></span><div><b>Supports healthy blood sugar metabolism</b> with a daily, easy-to-take capsule.*</div></div>
              <div class="li"><span class="check"></span><div><b>Helps curb snack cravings</b> so it‚Äôs easier to manage calories.*</div></div>
              <div class="li"><span class="check"></span><div><b>Promotes steady energy</b> throughout the day ‚Äî feel balanced, not jittery.*</div></div>
              <div class="li"><span class="check"></span><div><b>Backed by a clean formula</b> ‚Äî non-GMO and made in GMP-compliant facilities.</div></div>
            </div>
            <p class="notice" role="note">*These statements are for general wellness support and have not been evaluated by any food or drug authority. This product is not intended to diagnose, treat, cure, or prevent any disease.</p>
          </div>
        </div>

        <div class="card" style="margin-top:14px">
          <div class="pad">
            <h3>FAQs</h3>
            <details>
              <summary>Is it really free?</summary>
              <p>Yes. Your first bottle is free. You only pay a one-time $2.50 shipping & handling to cover delivery. There are <b>no</b> hidden fees and <b>no</b> auto-ship programs.</p>
            </details>
            <details>
              <summary>How do I take it?</summary>
              <p>Take 2 capsules daily with water, preferably with a meal.</p>
            </details>
            <details>
              <summary>Will it help with weight loss?</summary>
              <p>GlucoNova supports healthy glucose metabolism and appetite control, which can make weight management easier when combined with healthy eating and activity.*</p>
            </details>
          </div>
        </div>
      </div>
    </div>

    <!-- Right: checkout -->
    <div class="card checkout" id="checkoutCard">
      <div class="head">
        <h3>Claim Your Free Bottle</h3>
        <div class="muted">Secure checkout</div>
      </div>
      <div class="pad">
        <div class="row" style="margin-bottom:8px">
          <input id="emailInput" class="input" type="email" placeholder="Email address"/>
          <input id="nameInput" class="input" placeholder="Full name"/>
        </div>
        <div style="margin-bottom:8px">
          <div class="phone">
            <select id="phonePrefix" class="input" aria-label="Country calling code"></select>
            <input id="phoneNumber" class="input" type="tel" inputmode="tel" placeholder="Phone number"/>
          </div>
        </div>
        <div class="row" style="margin-bottom:8px">
          <input id="billingStreet" class="input" placeholder="Address line 1"/>
          <input id="billingCity" class="input" placeholder="City"/>
        </div>
        <div class="row" style="margin-bottom:8px">
          <input id="billingPostcode" class="input" placeholder="Postal code"/>
          <select id="billingCountry" class="input"></select>
        </div>

        <div class="muted" style="margin:8px 0 4px">Card number (for $2.50 shipping)</div>
        <div id="card-number" class="el"></div>
        <div class="row" style="margin-top:8px">
          <div>
            <div class="muted" style="margin:8px 0 4px">Expiry</div>
            <div id="card-expiry" class="el"></div>
          </div>
          <div>
            <div class="muted" style="margin:8px 0 4px">CVC</div>
            <div id="card-cvc" class="el"></div>
          </div>
        </div>

        <div class="notice" style="margin-top:10px">
          <b>No hidden fees.</b> You will only be charged <b>$2.50</b> for shipping & handling today.
        </div>

        <div id="err" role="alert" aria-hidden="true"></div>

        <button id="payNow" class="paybtn" style="margin-top:12px">Get My Free Bottle</button>
        <p class="muted" style="margin:10px 0 0">üîí 256-bit SSL Secure Payment</p>
      </div>
      <div class="trust">
        <img src="https://upload.wikimedia.org/wikipedia/commons/0/04/Visa.svg" alt="Visa"/>
        <img src="https://charmr.xyz/logos/mc2.png" alt="Mastercard"/>
        <img src="https://charmr.xyz/logos/amex.png" alt="Amex"/>
        <img src="https://www.gstatic.com/instantbuy/svg/dark_gpay.svg" alt="GPay"/>
      </div>
    </div>
  </section>

  <!-- Loading overlay -->
  <div id="overlay" class="overlay" aria-hidden="true">
    <div class="box">
      <h3>Processing‚Ä¶</h3>
      <div class="bar"><span></span></div>
      <p class="muted">Please wait, this may take a few seconds.</p>
    </div>
  </div>

  <footer>
    <b>Disclaimer:</b> Statements have not been evaluated by any food or drug authority. GlucoNova products are not intended to diagnose, treat, cure, or prevent disease. Consult a physician if you are pregnant, nursing, taking medication, or have a medical condition.
  </footer>

  <!-- Stripe.js -->
  <script src="https://js.stripe.com/v3"></script>
  <script>
    /* Countdown */
    (function countdownLoop(){
      const hh=document.getElementById('hh'), mm=document.getElementById('mm'), ss=document.getElementById('ss');
      const DURATION_MS = 15*60*1000;
      let end = Date.now() + DURATION_MS;
      const fmt=n=>String(n).padStart(2,'0');
      (function tick(){
        const left = Math.max(0, end - Date.now());
        const s = Math.floor(left/1000)%60;
        const m = Math.floor(left/60000)%60;
        const h = Math.floor(left/3600000);
        hh.textContent=fmt(h); mm.textContent=fmt(m); ss.textContent=fmt(s);
        if(left<=0){ end = Date.now() + DURATION_MS; }
        requestAnimationFrame(tick);
      })();
    })();

    /* Allowed phone prefixes and countries (US, CA, AU, NZ only) */
    const ALLOWED = {
      US: { prefix: '+1',  name: 'United States' },
      CA: { prefix: '+1',  name: 'Canada' },
      AU: { prefix: '+61', name: 'Australia' },
      NZ: { prefix: '+64', name: 'New Zealand' },
    };

    function populateAllowed(selectEl, selectedCC) {
      if(!selectEl) return;
      selectEl.innerHTML = '';
      const entries = Object.entries(ALLOWED);
      entries.forEach(([cc, data])=>{
        const label = `${data.prefix} ‚Äî ${data.name}`;
        const opt = new Option(label, data.prefix, false, cc===selectedCC);
        opt.dataset.cc = cc;
        selectEl.add(opt);
      });
      if(![...selectEl.options].some(o=>o.selected)) selectEl.selectedIndex = 0;
    }

    function populateCountries(countrySel, selectedCC){
      if(!countrySel) return;
      countrySel.innerHTML = '';
      const entries = Object.entries(ALLOWED);
      entries.forEach(([cc, data])=>{
        const opt = new Option(data.name, cc, false, cc===selectedCC);
        countrySel.add(opt);
      });
      if(![...countrySel.options].some(o=>o.selected)) countrySel.selectedIndex = 0;
    }

    /* Geo-detect by IP (primary: ipapi.co, fallback: ipwho.is) */
    async function detectCountryCode(){
      try{
        const r = await fetch('https://ipapi.co/json/');
        if(r.ok){
          const j = await r.json();
          return (j && j.country_code) || null;
        }
      }catch(_){}
      try{
        const r2 = await fetch('https://ipwho.is/');
        if(r2.ok){
          const j2 = await r2.json();
          return (j2 && j2.country_code) || null;
        }
      }catch(_){}
      const m = (navigator.language || '').toUpperCase().match(/-([A-Z]{2})$/);
      return m ? m[1] : null;
    }

    (async function initGeoUI(){
      const prefixEl = document.getElementById('phonePrefix');
      const phoneEl  = document.getElementById('phoneNumber');
      const countryEl= document.getElementById('billingCountry');

      let cc = (await detectCountryCode()) || 'US';
      if(!ALLOWED[cc]) cc = 'US';

      populateAllowed(prefixEl, cc);
      populateCountries(countryEl, cc);

      if (phoneEl) { phoneEl.disabled=false; phoneEl.readOnly=false; }
    })();

    /* ENDPOINT: match atlas-style intro-charge */
    const SUBSCRIBE_URL = "https://charmr-jfmc.onrender.com/api/stripe/intro-charge-20";

    const PUBLISHABLE_KEY = "pk_live_51Rhm4sEJXIhiKzYGIPVjXwZTzuKmqU7EOA6EpDIkrNTmtm4ooWHbDcSaBlyglSdJYhCyU4VgcI8Qo09Acc8upCUD00ekSRuN4q";
    const stripe = Stripe(PUBLISHABLE_KEY);
    const elements = stripe.elements();
    const cardNumber=elements.create("cardNumber");
    const cardExpiry=elements.create("cardExpiry");
    const cardCvc=elements.create("cardCvc");
    cardNumber.mount("#card-number"); cardExpiry.mount("#card-expiry"); cardCvc.mount("#card-cvc");

    const $err=document.getElementById("err");
    const overlay=document.getElementById('overlay');
    const showError=m=>{$err.textContent=m;$err.setAttribute('aria-hidden','false');}
    const hideError=()=>{$err.textContent="";$err.setAttribute('aria-hidden','true');}
    const showLoading=()=>overlay.setAttribute('aria-hidden','false');
    const hideLoading=()=>overlay.setAttribute('aria-hidden','true');

    const nameInput=document.getElementById('nameInput');
    const emailInput=document.getElementById('emailInput');
    const phonePrefix=document.getElementById('phonePrefix');
    const phoneNumber=document.getElementById('phoneNumber');
    const billingStreet=document.getElementById('billingStreet');
    const billingCity=document.getElementById('billingCity');
    const billingPostcode=document.getElementById('billingPostcode');
    const billingCountry=document.getElementById('billingCountry');

    document.getElementById("payNow").onclick = async () => {
      hideError(); showLoading();
      const rawPhone=(phoneNumber?.value||'').replace(/[^\d]/g,'');
      const selectedCC = billingCountry.value || 'US';
      const prefixFromCountry = (ALLOWED[selectedCC] && ALLOWED[selectedCC].prefix) || '+1';
      const fullPhone = rawPhone ? `${prefixFromCountry}${rawPhone}` : undefined;

      const addr = {
        line1:(billingStreet?.value||'').trim()||undefined,
        city:(billingCity?.value||'').trim()||undefined,
        postal_code:(billingPostcode?.value||'').trim()||undefined,
        country:selectedCC
      };

      const pm = await stripe.createPaymentMethod({
        type:"card",
        card:cardNumber,
        billing_details:{
          name:nameInput.value||undefined,
          email:emailInput.value||undefined,
          phone:fullPhone,
          address:addr
        }
      });
      if(pm.error){ hideLoading(); showError(pm.error.message); return; }

      try{
        const res = await fetch(SUBSCRIBE_URL,{
          method:"POST",
          headers:{"Content-Type":"application/json"},
          body:JSON.stringify({
            paymentMethodId:pm.paymentMethod.id,
            name:nameInput.value,
            email:emailInput.value,
            phone:fullPhone,
            address:addr,
            amount:250 // cents
          })
        });
        const data = await res.json();
        if(data.error){ hideLoading(); showError(data.error); return; }
        if(!data.clientSecret){ hideLoading(); showError("Payment failed"); return; }

        const conf = await stripe.confirmCardPayment(data.clientSecret);
        if(conf.error){ hideLoading(); showError(conf.error.message); return; }
        if(!(conf.paymentIntent && conf.paymentIntent.status === "succeeded")){
          hideLoading(); showError("Payment not completed"); return;
        }

        // Success ‚Üí BeMob tracker with atlas2-style params
        (function(){
          const TRACKER_URL = "https://cudsr.bemobtrcks.com/go/abc281a7-e82a-411b-8b56-1a0228d7d2e7";
          const pid = (conf && conf.paymentIntent && conf.paymentIntent.id) || data.paymentIntentId || "";
          const qp = new URLSearchParams(pid ? { v: pid } : { t: String(Date.now()) });

          try{
            const ck = document.cookie.match(/(?:^|; )aff_sub_id=([^;]*)/);
            const sub = ck ? decodeURIComponent(ck[1]) : (localStorage.getItem("aff_sub_id") || "");
            if (sub) {
              qp.set("sub_id",  sub);
              qp.set("subid",   sub);
              qp.set("aff_sub", sub);
              qp.set("click_id",sub);
              qp.set("cid",     sub);
              qp.set("tid",     sub);
            }
          }catch(e){}

          // Forward affiliate Meta Pixel ID if present
          try{
            const srcQs = new URLSearchParams(location.search);
            const affiliatePixel = srcQs.get("pixel") || srcQs.get("fb_pixel") || srcQs.get("fbp");
            if (affiliatePixel) qp.set("pixel", affiliatePixel);
          }catch(e){}

          const sep = TRACKER_URL.includes("?") ? "&" : "?";
          window.location.href = TRACKER_URL + sep + qp.toString();
        })();

      }catch(e){
        hideLoading();
        showError(e.message||"Something went wrong");
      }
    };
  </script>
  <!-- GoAffPro loader (kept, matches atlas.html integration) -->
  <script type="text/javascript" src="https://api.goaffpro.com/loader.js?shop=nzyvwvfbde"></script>
</body>
</html>
